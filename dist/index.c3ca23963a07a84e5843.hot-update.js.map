{"version":3,"sources":["webpack:///./app/index.js?undefined"],"names":["App","constructor","app","koa","init","obj","name","age","addRoute","listen","addStatic","koaStatic","path","__dirname","maxage","index","connectRedis","promise","reslove","reject","Redis","console","log","connectSql","connection","err","CheckTable","Route","server","port","setTimeout"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMA,GAAN,CAAU;AACRC,aAAW,GAAG;AACZ,SAAKC,GAAL,GAAW,IAAIC,4CAAJ,EAAX;AACA,SAAKC,IAAL;AACA,QAAIC,GAAG,GAAG;AACRC,UAAI,EAAE,GADE;AAERC,SAAG,EAAE;AAFG,KAAV;AAID;;AACD,QAAMH,IAAN,GAAa;AACX;AACA;AACA;AACA;AACA;AACA,SAAKI,QAAL,GANW,CAOX;;AACA,SAAKC,MAAL;AACD;;AACD,QAAMC,SAAN,GAAkB;AAChBC,qDAAS,CAACC,gDAAA,CAAUC,SAAV,EAAqB,UAArB,CAAD,EAAmC;AAC1CC,YAAM,EAAE,MAAM,EAAN,GAAW,EAAX,GAAgB,IADkB;AAE1CC,WAAK,EAAE,MAFmC,CAG1C;;AAH0C,KAAnC,CAAT;AAKD;;AACD,QAAMC,YAAN,GAAqB;AACnB,UAAMC,+CAAO,CAAC,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACjCC,uDAAA,CAAc,MAAM;AAClBC,eAAO,CAACC,GAAR,CAAY,YAAZ;AACAJ,eAAO;AACR,OAHD;AAIAE,qDAAA,CAAY,MAAM;AAChBC,eAAO,CAACC,GAAR,CAAY,YAAZ;AACAH,cAAM;AACP,OAHD;AAID,KATY,CAAb;AAUD;;AACD,QAAMI,UAAN,GAAmB;AACjB,UAAMN,+CAAO,CAAC,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACjCK,kEAAA,CAAoBC,GAAD,IAAS;AAC1B,YAAIA,GAAJ,EAAS;AACPJ,iBAAO,CAACC,GAAR,CAAY,QAAZ;AACAH,gBAAM;AACN,gBAAMM,GAAN;AACD;;AACD,YAAIC,oDAAJ;AACAL,eAAO,CAACC,GAAR,CAAY,cAAZ;AACAJ,eAAO;AACR,OATD;AAUD,KAXY,CAAb;AAYD;;AACDV,UAAQ,GAAG;AACT;AACA,QAAImB,kDAAJ,CAAU,KAAKzB,GAAf;AACD;;AACDO,QAAM,GAAG;AACP;AACA;AACA;AAEA,SAAKmB,MAAL,GAAc,KAAK1B,GAAL,CAASO,MAAT,CAAgBoB,0CAAhB,EAAsB,MAAM;AACxCR,aAAO,CAACC,GAAR,CAAa,4BAA2BO,0CAAK,GAA7C;AACD,KAFa,CAAd;AAIA,SAAKD,MAAL,CAAYE,UAAZ,CAAuB,IAAI,EAAJ,GAAS,IAAhC;AACD;;AAlEO;;AAqEV,iEAAe,IAAI9B,GAAJ,EAAf,E","file":"index.c3ca23963a07a84e5843.hot-update.js","sourcesContent":["import \"@babel/polyfill\";\nimport path from \"path\";\nimport koa from \"koa\";\nimport koaStatic from \"koa-static\";\nimport { renderToString } from \"react-dom/server\";\nimport { promise } from \"./utils\";\nimport { CheckTable, connection, exec, addUser } from \"./db/index.js\";\nimport { Redis } from \"./redis\";\nimport Route from \"./routes/index\";\nimport kill from \"kill-port\";\nimport { port } from \"./config\";\n\nclass App {\n  constructor() {\n    this.app = new koa();\n    this.init();\n    var obj = {\n      name: \"1\",\n      age: 2,\n    };\n  }\n  async init() {\n    // redis链接\n    // await this.connectRedis();\n    // 数据库连接\n    // await this.connectSql();\n    //加载路由\n    this.addRoute();\n    // 设置监听端口\n    this.listen();\n  }\n  async addStatic() {\n    koaStatic(path.join(__dirname, \"../build\"), {\n      maxage: 365 * 24 * 60 * 1000,\n      index: \"root\",\n      // 这里配置不要写成'index'就可以了，因为在访问localhost:3030时，不能让服务默认去加载index.html文件，这里很容易掉进坑。\n    });\n  }\n  async connectRedis() {\n    await promise((reslove, reject) => {\n      Redis.connect(() => {\n        console.log(\"Redis 链接成功\");\n        reslove();\n      });\n      Redis.error(() => {\n        console.log(\"Redis 链接错误\");\n        reject();\n      });\n    });\n  }\n  async connectSql() {\n    await promise((reslove, reject) => {\n      connection.connect((err) => {\n        if (err) {\n          console.log(\"数据库连失败\");\n          reject();\n          throw err;\n        }\n        new CheckTable();\n        console.log(\"mysql数据库连接成功\");\n        reslove();\n      });\n    });\n  }\n  addRoute() {\n    // 导入路由\n    new Route(this.app);\n  }\n  listen() {\n    // try {\n    //    kill(port, \"tcp\");\n    // } catch (e) {}\n\n    this.server = this.app.listen(port, () => {\n      console.log(`服务器启动成功:http://localhost:${port}/`);\n    });\n\n    this.server.setTimeout(5 * 60 * 1000);\n  }\n}\n\nexport default new App();\n"],"sourceRoot":""}